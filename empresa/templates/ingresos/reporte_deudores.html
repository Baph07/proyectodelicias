{% extends "base.html" %}

{% block content %}
<div class="table-card">
    <h2>Reporte de Deudores ðŸ’³</h2>

    {% for venta in ventas %}
        <div class="card">
            <h3>Venta #{{ venta.id }}</h3>
            <p>Fecha: {{ venta.fecha|date:"d/m/Y H:i" }}</p>

            <ul>
                {% for producto in venta.productos.all %}
                    <li>
                        {{ producto.cantidad }} x
                        {% if producto.categoria == 'Helados' %}
                            {{ producto.tipo_helado }} ({{ producto.sabor1 }}{% if producto.sabor2 %}, {{ producto.sabor2 }}{% endif %})
                        {% elif producto.categoria == 'Postres' %}
                            {{ producto.tipo_postre }}
                            {% if producto.tamaÃ±o %} ({{ producto.tamaÃ±o }}){% endif %}
                            {% if producto.sabor1 %} ({{ producto.sabor1 }}){% endif %}
                        {% elif producto.categoria == 'Otros' %}
                            {{ producto.nombre }}
                        {% endif %}

                        â€” ${{ producto.precio_unitario }} c/u
                        â†’ <strong>${{ producto.subtotal }}</strong>
                    </li>
                {% endfor %}
            </ul>

            <p><strong>Total:</strong> ${{ venta.total }}</p>

            {% if venta.total_bs %}
                <p><strong>Total en Bs:</strong> {{ venta.total_bs }}</p>
            {% endif %}

            {% if venta.metodo_pago %}
                <p><strong>MÃ©todo de pago:</strong> {{ venta.metodo_pago }}</p>
            {% else %}
                <!-- BOTÃ“N PAGAR DEUDA -->
                <form method="GET" action="{% url 'pagar_deuda' venta.id %}">
                    <button type="submit" class="btn btn-success">Pagar Deuda</button>
                </form>
            {% endif %}

        </div>
    {% empty %}
        <p>No hay ventas a crÃ©dito registradas.</p>
    {% endfor %}
</div>
{% endblock %}
